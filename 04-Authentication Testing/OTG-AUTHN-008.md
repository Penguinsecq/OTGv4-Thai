ในบทนี้เป็นการทดสอบ function ที่เกี่ยวกับ security questions และ answers ที่ใช้ในกระบวนการ recovery password หรือ forgot password ของ user ซึ่งถ้ามีการออกแบบและตั้งคำถาม คำตอบที่ไม่ดีพอ ก็อาจจะถูกโจมตีเช่น จากการคาดเดา หรือการหาข้อมูลของผู้ใช้งานบน social media เพื่อนำมาเดาคำถาม คำตอบได้ง่าย


	1. 
Testing for Weak Pre-generated Questions


            ลองพยายามรวบรวมรายการ security question ที่ถูก generate ออกมาให้ได้มากที่สุด อาจจะด้วยการกด "Forget password", password recovery  หรือ สร้าง account ใหม่ๆ เพื่อพิจารณาว่า เราจะสามารถคาดเดาคำถามได้ง่ายเพียงใด 

	1. 
Testing for Weak Self-Generated Questions


            ระบบที่อนุญาตให้ user สามารถตั้ง security question ได้เอง ก็จะมีปัญหาว่าผู้ใช้งานอาจจะตั้งคำถามที่คาดเดาได้ง่าย และกรณีที่ตัว function "forgot password" ใดที่มีช่องโหว่ OTG-IDENT-004 ซึ่งผู้โจมตีสามารถคาดเดา username ของผู้ใช้งานได้แล้ว จะยิ่งทีำให้ผู้โจมตีมีช่องทางในการตรวจสอบและจดบันทึก security question ได้จำนวนมากขึ้นและนำไปใช้โจมตีในส่วนอื่นต่อไป

	1. 
Testing for Brute-forcible Answers


            เป็นการทดสอบ brute-force คำตอบ ซึ่งในการทดสอบข้อนี้ ก็ต้องระวังเรื่องของ account จะถูก lock จากการตอบคำถามผิดตามจำนวนครั้งที่กำหนดจาก application ด้วยนะครับ 
            โดยอย่างแรกที่ต้องคำนึงถึงก็คือ จำนวนคำถามที่ต้องตอบให้ถูก ถ้า application ที่สำคัญก็อาจจะมีได้หลายคำถามเพื่อความปลอดภัย 
            อย่างที่สองก็จะเป็นเรื่องความยากในการคาดเดาของ security questions ในระบบนั้นๆ เช่นถามคำถามที่สามารถหาคำตอบได้จากการ search social media แบบนี้ถือว่าไม่เหมาะสม โดย owasp ก็เขียนเป็น step ให้ว่าต้องทำอะไรบ้าง ดังนี้
	* 
    ตัว application ที่ทำการทดสอบอนุญาตให้ผู้ใช้งานเลือกคำถามที่จะตอบเองได้หรือไม่ ซึ่งถ้าได้ ผู้ทดสอบก็ควรจะคำนึงถึง

		* 
คำตอบที่หาได้ง่ายจากการใช้ search engine
		* 
คำตอบที่เป็นข้อเท็จจริงซึ่งค้นหาได้ง่ายเช่น "โรงเรียนแห่งแรก"
		* 
คำถามที่มีจำนวนคำตอบที่ไม่เยอะ เช่น "รถคันแรกยี่ห้ออะไร" เป็นต้น
	* 
สามารถเดาคำตอบได้กี่ครั้ง

		* 
คาดเดาได้ไม่จำกัดหรือไม่?
		* 
lock out mechanism เป็นอย่างไร และเหมาะสมหรือไม่ เพราะการป้องกันด้วยวิธีนี้ก็มีผลทำให้เกิดปัญหาทาง security ได้เช่นเดียวกัน เพราะถ้าเกิดว่ามีการ lock account ที่ตอบคำถามผิดหลายครั้ง ผู้ใช้คนดังกล่าวก็จะไม่สามารถใช้งาน account ของตัวเองได้ ถือว่าผู้โจมตีก็สามารถทำ DOS ได้
		* 
เลือกคำถามที่คิดว่าสามารถคาดเดาได้ง่าย และทำการ research เพื่อให้ได้คำตอบที่เป็นไปได้มากที่สุดในการทดสอบ


        

https://github.com/OWASP/wstg/blob/master/document/4_Web_Application_Security_Testing/4.5_Authentication_Testing/4.5.8_Testing_for_Weak_Security_Question_Answer_OTG-AUTHN-008.md
