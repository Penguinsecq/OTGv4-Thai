# Conduct Search Engine Discovery Reconnaissance for Information Leakage

## Summary

In order for search engines to work, computer programs (or "robots") regularly fetch data (referred to as [crawling](https://en.wikipedia.org/wiki/Web_crawler) from billions of pages on the web. These programs find web pages by following links from other pages, or by looking at sitemaps. If a website uses a special file called "robots.txt" to list pages that it does not want search engines to fetch, then the pages listed there will be ignored. This is a basic overview - Google offers a more in-depth explanation of [how a search engine works](https://support.google.com/webmasters/answer/70897?hl=en).

Testers can use search engines to perform reconnaissance on websites and web applications. There are direct and indirect elements to search engine discovery and reconnaissance: direct methods relate to searching the indexes and the associated content from caches, while indirect methods relate to learning sensitive design and configuration information by searching forums, newsgroups, and tendering websites.

Once a search engine robot has completed crawling, it commences indexing the web page based on tags and associated attributes, such as `<TITLE>`, in order to return the relevant search results. If the robots.txt file is not updated during the lifetime of the web site, and inline HTML meta tags that instruct robots not to index content have not been used, then it is possible for indexes to contain web content not intended to be included by the owners. Website owners may use the previously mentioned robots.txt, HTML meta tags, authentication, and tools provided by search engines to remove such content.

## Test Objectives

To understand what sensitive design and configuration information of the application, system, or organization is exposed both directly (on the organization's website) or indirectly (on a third party website).
OTG-INFO-001
How to test

1.  ใช้ google operator search ที่เกี่ยวข้องกับข้อมูลที่ต้องการค้นหา เช่น

•  ต้องการค้นหา Network diagrams and configurations
site:cophone.com
filetype:pdf vsd txt

•  ต้องการค้นหา โพสต์ และ email ที่ admin ได้เคยโพสต์ไว้Archived posts and emails by administrators and other key staff
for social network
@facebook pentest01
@twitter pentest01

•  ค้นหาวิธีการ Log on เข้าใช้งานเป้าหมาย และรูปแบบของ username 
ในกรณีที่ได้รับ username จากลูกค้ามาเพื่อทำการทดสอบแบบ grey-box

•  Usernames and passwords
inurl:"/root/etc/passwd" intext:"home/*:"
inurl:admin inurl:userlist

ตัวอย่างการค้นหา

![image](https://user-images.githubusercontent.com/60565002/73606207-a0222200-45da-11ea-9eb1-4d5a42ae4a4c.png)

•  ค้นหาจาก Error message 
inurl:".php?id=" "You have an error in your SQL syntax"

•  Development, test, UAT and staging versions of the website

2. ลองทำการค้นหาด้วย search engine อื่นๆ

Ref : https://github.com/OWASP/wstg/blob/master/document/4_Web_Application_Security_Testing/4.2_Information_Gathering/4.2.1_Conduct_Search_Engine_Discovery_Reconnaissance_for_Information_Leakage_OTG-INFO-001.md

update : 01/2563
